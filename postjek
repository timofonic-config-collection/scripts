#!/usr/bin/mksh
# Script by Ypnose - http://ypnose.org
# Generate "ready-to-write" Jekyll posts & pages.

DIR=${HOME}/Repos/JekyBlog

if [[ -z $1 || $1 = "-h" ]]; then
	print "Usage: ${0##*/} [-p page_name] article_title"
	print "    -p   Create a new page instead of a new post/article"
	exit 1
fi

# Generate page
if (( $# == 2 )) && [[ $1 = "-p" ]]; then
	NEWFOL="$2"
	typeset -l NEWFOL
	mkdir -p "${DIR}/${NEWFOL}" && cd "${DIR}/${NEWFOL}"
	print "You may rename the folder!"
	cat >> index.md <<- EOF
	---
	layout: page
	title: "$2"
	---
	EOF
	exit 0
fi

# Generate post
DAYDAT=$(date "+%Y-%m-%d")
NAME=${1// /-}
typeset -l NAME
ART="${DAYDAT}-${NAME}.md"

if [[ -d $DIR/_drafts ]]; then
	cd "${DIR}/_drafts"
	cat >> "${ART}" <<- EOF
	---
	layout: post
	title: "$1"
	date: $DAYDAT `date "+%H:%M:%S"`
	description: 
	categories:
	---
	EOF
else
	print -u2 "Directory doesn't exist!"
	exit 1
fi
exit 0
